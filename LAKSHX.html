<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAKSHX </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --bg-deep: #02040a;
            --accent-primary: #6366f1;
            --accent-glow: rgba(99, 102, 241, 0.15);
            --glass: rgba(15, 23, 42, 0.65);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-deep);
            color: #f8fafc;
            overflow: hidden;
            height: 100vh;
        }

        .glass-panel {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.8);
        }

        .neon-text {
            text-shadow: 0 0 20px var(--accent-glow);
        }

        .sidebar-item.active {
            background: linear-gradient(90deg, rgba(99, 102, 241, 0.1) 0%, transparent 100%);
            border-left: 3px solid var(--accent-primary);
            color: white;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) scale(1); opacity: 0.3; }
            50% { transform: translateY(-20px) scale(1.1); opacity: 0.6; }
        }

        .bg-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            animation: float 15s infinite ease-in-out;
        }

        .custom-scroll::-webkit-scrollbar { width: 5px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }

        .btn-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .btn-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 20px -10px var(--accent-primary); }
    </style>
</head>
<body class="flex">

    <!-- Dynamic Background Elements -->
    <div class="bg-orb w-96 h-96 bg-indigo-600/20 top-[-10%] left-[-10%]"></div>
    <div class="bg-orb w-[500px] h-[500px] bg-purple-600/10 bottom-[-10%] right-[-10%] animate-delay-2000"></div>

    <!-- Sidebar Navigation -->
    <aside class="w-20 md:w-72 glass-panel h-full border-r border-white/5 flex flex-col z-50">
        <div class="p-8 flex items-center gap-4">
            <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center shadow-lg">
                <i data-lucide="zap" class="text-white w-6 h-6"></i>
            </div>
            <span class="hidden md:block font-bold text-xl tracking-tight">LAKSHX <span class="text-indigo-500">TITAN</span></span>
        </div>

        <nav class="flex-1 px-4 space-y-2">
            <button onclick="switchTab('dashboard')" id="nav-dashboard" class="sidebar-item active w-full flex items-center p-4 rounded-xl text-slate-400 gap-4 btn-hover">
                <i data-lucide="layout-dashboard"></i> <span class="hidden md:block font-medium">LAKSHX Sanctuary</span>
            </button>
            <button onclick="switchTab('timer')" id="nav-timer" class="sidebar-item w-full flex items-center p-4 rounded-xl text-slate-400 gap-4 btn-hover">
                <i data-lucide="timer"></i> <span class="hidden md:block font-medium">LAKSHX Engine</span>
            </button>
            <button onclick="switchTab('tasks')" id="nav-tasks" class="sidebar-item w-full flex items-center p-4 rounded-xl text-slate-400 gap-4 btn-hover">
                <i data-lucide="target"></i> <span class="hidden md:block font-medium">LAKSHX Tasks</span>
            </button>
            <button onclick="switchTab('calculator')" id="nav-calculator" class="sidebar-item w-full flex items-center p-4 rounded-xl text-slate-400 gap-4 btn-hover">
                <i data-lucide="atom"></i> <span class="hidden md:block font-medium">LAKSHX Physics Lab</span>
            </button>
        </nav>

        <div class="p-6">
            <div class="glass-panel rounded-2xl p-4 hidden md:block border-indigo-500/20">
                <p class="text-[10px] font-bold text-indigo-400 uppercase tracking-widest mb-2">LAKSHX Streak</p>
                <div class="flex items-center gap-2">
                    <i data-lucide="flame" class="text-orange-500 w-5 h-5"></i>
                    <span id="streak-count" class="text-xl font-bold">12 Days</span>
                </div>
            </div>
        </div>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-1 h-full overflow-hidden relative flex flex-col">
        
        <!-- Header -->
        <header class="h-20 flex items-center justify-between px-12 border-b border-white/5">
            <div class="flex items-center gap-3">
                <span id="current-date" class="text-slate-400 text-sm font-medium">Monday, February 2, 2026</span>
            </div>
            <div class="flex items-center gap-6">
                <div class="flex items-center gap-2 text-emerald-400 bg-emerald-500/10 px-4 py-1.5 rounded-full text-xs font-bold border border-emerald-500/20">
                    <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span> LAKSHX SYSTEM READY
                </div>
                <button onclick="toggleAmbient()" id="ambient-btn" class="p-2 rounded-full hover:bg-white/5 text-slate-400 transition-all">
                    <i data-lucide="volume-2"></i>
                </button>
            </div>
        </header>

        <div id="content-container" class="flex-1 overflow-y-auto p-12 custom-scroll">
            <!-- Content will be injected here via JavaScript -->
        </div>

    </main>

    <script>
        // --- CONSTANTS & STATE ---
        const apiKey = ""; 
        let currentTab = 'dashboard';
        let ambientPlaying = false;
        let tasks = JSON.parse(localStorage.getItem('lakshx-tasks') || '[]');
        let timerSeconds = 1500;
        let timerInterval = null;
        let audioContext = null;

        // --- CORE UI ENGINE ---
        function switchTab(tabId) {
            currentTab = tabId;
            document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active'));
            document.getElementById(`nav-${tabId}`).classList.add('active');
            render();
        }

        function render() {
            const container = document.getElementById('content-container');
            container.innerHTML = '';

            if (currentTab === 'dashboard') {
                container.innerHTML = `
                    <div class="animate-in fade-in slide-in-from-bottom-4 duration-700 flex flex-col items-center justify-center h-full text-center space-y-12">
                        <div class="space-y-4">
                            <h1 id="clock" class="text-[12rem] font-extralight tracking-tighter neon-text tabular-nums leading-none">00:00</h1>
                            <p class="text-slate-400 tracking-[0.5em] uppercase text-sm font-medium">LAKSHX Protocol Active</p>
                        </div>
                        <div class="w-full max-w-2xl glass-panel p-8 rounded-[3rem] flex items-center gap-8 text-left border-indigo-500/10">
                            <div class="p-6 bg-indigo-500/10 rounded-3xl text-indigo-400">
                                <i data-lucide="brain-circuit" class="w-10 h-10"></i>
                            </div>
                            <div>
                                <h3 class="text-indigo-300 text-xs font-bold uppercase tracking-widest mb-1">LAKSHX Coach Insight</h3>
                                <p id="ai-insight" class="text-slate-200 text-lg italic font-light">"Preparing for JEE? Focus on the symmetry of Maxwell's equations today."</p>
                                <button onclick="fetchCoachTip()" class="mt-4 flex items-center gap-2 text-indigo-400 text-sm font-bold hover:text-indigo-300 transition-all">
                                    <i data-lucide="sparkles" class="w-4 h-4"></i> ASK LAKSHX COACH
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                updateClock();
            } else if (currentTab === 'timer') {
                container.innerHTML = `
                    <div class="h-full flex flex-col items-center justify-center animate-in zoom-in-95 duration-500">
                        <div class="relative w-80 h-80 flex items-center justify-center mb-12">
                            <svg class="absolute inset-0 w-full h-full -rotate-90">
                                <circle cx="160" cy="160" r="150" fill="transparent" stroke="rgba(255,255,255,0.05)" stroke-width="8"></circle>
                                <circle id="timer-progress" cx="160" cy="160" r="150" fill="transparent" stroke="#6366f1" stroke-width="8" stroke-dasharray="942" stroke-dashoffset="0" stroke-linecap="round" class="transition-all duration-1000"></circle>
                            </svg>
                            <span id="timer-display" class="text-7xl font-thin tracking-tighter tabular-nums">${formatTime(timerSeconds)}</span>
                        </div>
                        <div class="flex items-center gap-6">
                            <button onclick="toggleTimer()" id="timer-btn" class="w-20 h-20 bg-indigo-600 rounded-full flex items-center justify-center shadow-xl hover:scale-105 transition-all text-white">
                                <i data-lucide="play" class="fill-current"></i>
                            </button>
                            <button onclick="resetTimer()" class="p-4 rounded-full bg-white/5 text-slate-400 hover:text-white transition-all">
                                <i data-lucide="rotate-ccw"></i>
                            </button>
                        </div>
                    </div>
                `;
            } else if (currentTab === 'tasks') {
                container.innerHTML = `
                    <div class="max-w-3xl mx-auto space-y-8 animate-in slide-in-from-right-4 duration-500">
                        <div class="flex justify-between items-end">
                            <div>
                                <h1 class="text-4xl font-bold mb-2">LAKSHX Goals</h1>
                                <p class="text-slate-500">Master your academic schedule.</p>
                            </div>
                            <div class="text-right">
                                <span class="block text-3xl font-bold text-indigo-400">${tasks.filter(t => t.completed).length}/${tasks.length}</span>
                                <span class="text-[10px] text-slate-500 uppercase tracking-widest font-bold">LAKSHX Progress</span>
                            </div>
                        </div>
                        <div class="relative">
                            <input id="task-input" onkeypress="handleTaskKey(event)" type="text" placeholder="Add a new milestone..." class="w-full glass-panel bg-white/5 border-white/10 rounded-2xl p-5 pl-8 text-lg focus:ring-2 focus:ring-indigo-500/50 outline-none transition-all">
                            <button onclick="addTask()" class="absolute right-4 top-4 p-2 bg-indigo-600 rounded-xl hover:bg-indigo-500 transition-all"><i data-lucide="plus"></i></button>
                        </div>
                        <div id="task-list" class="space-y-4">
                            ${tasks.map(t => `
                                <div class="glass-panel p-5 rounded-2xl flex items-center justify-between border-white/5 group hover:border-indigo-500/30 transition-all">
                                    <div class="flex items-center gap-4">
                                        <button onclick="toggleTask(${t.id})" class="w-6 h-6 rounded-lg border-2 border-slate-600 flex items-center justify-center ${t.completed ? 'bg-indigo-600 border-indigo-600' : ''}">
                                            ${t.completed ? '<i data-lucide="check" class="w-4 h-4 text-white"></i>' : ''}
                                        </button>
                                        <span class="${t.completed ? 'line-through text-slate-600' : 'text-slate-200'} font-medium">${t.text}</span>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        ${!t.completed ? `<button onclick="breakdownAI(${t.id})" class="text-[10px] font-bold text-indigo-400 bg-indigo-500/10 px-3 py-1.5 rounded-lg border border-indigo-500/20 hover:bg-indigo-500/20">LAKSHX BREAKDOWN</button>` : ''}
                                        <button onclick="deleteTask(${t.id})" class="p-2 text-slate-600 hover:text-rose-500 transition-all opacity-0 group-hover:opacity-100"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            } else if (currentTab === 'calculator') {
                container.innerHTML = `
                    <div class="h-full flex flex-col items-center animate-in fade-in duration-500">
                        <div class="w-full max-w-md bg-slate-900/90 rounded-[2.5rem] p-8 border border-white/10 shadow-2xl">
                            <div class="text-right mb-6 px-2">
                                <div id="calc-eq" class="text-indigo-400 font-mono text-xs h-4 mb-1"></div>
                                <div id="calc-display" class="text-5xl font-light tracking-tighter text-slate-100 overflow-hidden">0</div>
                            </div>
                            <div class="grid grid-cols-4 gap-3">
                                ${['c', 'G', 'h', 'g'].map(c => `<button onclick="calcConst('${c}')" class="h-10 text-[10px] font-bold bg-indigo-500/10 text-indigo-300 rounded-xl hover:bg-indigo-500/20 border border-indigo-500/10">${c}</button>`).join('')}
                                <button onclick="calcClear()" class="col-span-2 h-12 bg-rose-500/20 text-rose-400 rounded-xl font-bold">AC</button>
                                <button onclick="calcFunc('sqrt')" class="h-12 bg-slate-800 text-slate-400 rounded-xl"><i data-lucide="square" class="w-4 h-4 inline-block -rotate-45"></i></button>
                                <button onclick="calcOp('/')" class="h-12 bg-indigo-500/20 text-indigo-300 rounded-xl">÷</button>
                                ${['7','8','9'].map(n => `<button onclick="calcNum('${n}')" class="h-12 bg-slate-800 rounded-xl hover:bg-slate-700 transition-all font-medium">${n}</button>`).join('')}
                                <button onclick="calcOp('*')" class="h-12 bg-indigo-500/20 text-indigo-300 rounded-xl">×</button>
                                ${['4','5','6'].map(n => `<button onclick="calcNum('${n}')" class="h-12 bg-slate-800 rounded-xl hover:bg-slate-700 transition-all font-medium">${n}</button>`).join('')}
                                <button onclick="calcOp('-')" class="h-12 bg-indigo-500/20 text-indigo-300 rounded-xl">-</button>
                                ${['1','2','3'].map(n => `<button onclick="calcNum('${n}')" class="h-12 bg-slate-800 rounded-xl hover:bg-slate-700 transition-all font-medium">${n}</button>`).join('')}
                                <button onclick="calcOp('+')" class="h-12 bg-indigo-500/20 text-indigo-300 rounded-xl">+</button>
                                <button onclick="calcNum('0')" class="h-12 bg-slate-800 rounded-xl">0</button>
                                <button onclick="calcNum('.')" class="h-12 bg-slate-800 rounded-xl">.</button>
                                <button onclick="calcSolve()" class="col-span-2 h-12 bg-emerald-500/20 text-emerald-300 rounded-xl font-bold hover:bg-emerald-500/30 transition-all">=</button>
                            </div>
                        </div>
                        <p class="mt-8 text-slate-500 text-xs font-mono uppercase tracking-widest text-center">LAKSHX Physics Core v2.0</p>
                    </div>
                `;
            }

            lucide.createIcons();
        }

        // --- CLOCK & DATE ---
        function updateClock() {
            if (currentTab !== 'dashboard') return;
            const now = new Date();
            const h = String(now.getHours()).padStart(2, '0');
            const m = String(now.getMinutes()).padStart(2, '0');
            const clockEl = document.getElementById('clock');
            if (clockEl) clockEl.innerText = `${h}:${m}`;
            
            const days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
            const months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
            document.getElementById('current-date').innerText = `${days[now.getDay()]}, ${months[now.getMonth()]} ${now.getDate()}, ${now.getFullYear()}`;
        }
        setInterval(updateClock, 1000);

        // --- TIMER ENGINE ---
        function formatTime(s) {
            const m = Math.floor(s / 60);
            const rs = s % 60;
            return `${String(m).padStart(2, '0')}:${String(rs).padStart(2, '0')}`;
        }

        function toggleTimer() {
            const btn = document.getElementById('timer-btn');
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
                btn.innerHTML = '<i data-lucide="play" class="fill-current"></i>';
            } else {
                timerInterval = setInterval(() => {
                    timerSeconds--;
                    updateTimerUI();
                    if (timerSeconds <= 0) {
                        clearInterval(timerInterval);
                        timerInterval = null;
                        alert("LAKSHX: Session Complete! Take a 5-minute break.");
                    }
                }, 1000);
                btn.innerHTML = '<i data-lucide="pause" class="fill-current"></i>';
            }
            lucide.createIcons();
        }

        function resetTimer() {
            clearInterval(timerInterval);
            timerInterval = null;
            timerSeconds = 1500;
            updateTimerUI();
            document.getElementById('timer-btn').innerHTML = '<i data-lucide="play" class="fill-current"></i>';
            lucide.createIcons();
        }

        function updateTimerUI() {
            const display = document.getElementById('timer-display');
            const progress = document.getElementById('timer-progress');
            if (display) display.innerText = formatTime(timerSeconds);
            if (progress) {
                const offset = (timerSeconds / 1500) * 942;
                progress.style.strokeDashoffset = 942 - offset;
            }
        }

        // --- AMBIENT AUDIO ---
        function toggleAmbient() {
            const btn = document.getElementById('ambient-btn');
            if (ambientPlaying) {
                audioContext.close();
                ambientPlaying = false;
                btn.classList.replace('text-indigo-400', 'text-slate-400');
            } else {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const bufferSize = 2 * audioContext.sampleRate;
                const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
                const output = noiseBuffer.getChannelData(0);
                for (let i = 0; i < bufferSize; i++) {
                    output[i] = Math.random() * 2 - 1;
                }
                const whiteNoise = audioContext.createBufferSource();
                whiteNoise.buffer = noiseBuffer;
                whiteNoise.loop = true;
                const filter = audioContext.createBiquadFilter();
                filter.type = 'lowpass';
                filter.frequency.setValueAtTime(400, audioContext.currentTime);
                const gain = audioContext.createGain();
                gain.gain.setValueAtTime(0.02, audioContext.currentTime);
                whiteNoise.connect(filter);
                filter.connect(gain);
                gain.connect(audioContext.destination);
                whiteNoise.start();
                ambientPlaying = true;
                btn.classList.replace('text-slate-400', 'text-indigo-400');
            }
        }

        // --- TASK MANAGEMENT ---
        function addTask() {
            const input = document.getElementById('task-input');
            if (!input.value.trim()) return;
            const newTask = { id: Date.now(), text: input.value, completed: false };
            tasks.unshift(newTask);
            input.value = '';
            saveAndRender();
        }

        function handleTaskKey(e) { if (e.key === 'Enter') addTask(); }

        function toggleTask(id) {
            tasks = tasks.map(t => t.id === id ? {...t, completed: !t.completed} : t);
            saveAndRender();
        }

        function deleteTask(id) {
            tasks = tasks.filter(t => t.id !== id);
            saveAndRender();
        }

        function saveAndRender() {
            localStorage.setItem('lakshx-tasks', JSON.stringify(tasks));
            render();
        }

        // --- CALCULATOR ENGINE ---
        let calcVal = '0';
        let calcEq = '';
        const physConsts = { c: 299792458, G: 6.674e-11, h: 6.626e-34, g: 9.81 };

        function calcNum(n) {
            calcVal = (calcVal === '0') ? n : calcVal + n;
            updateCalc();
        }
        function calcConst(k) { calcVal = String(physConsts[k]); updateCalc(); }
        function calcOp(op) { calcEq = calcVal + ' ' + op + ' '; calcVal = '0'; updateCalc(); }
        function calcClear() { calcVal = '0'; calcEq = ''; updateCalc(); }
        function calcSolve() {
            try {
                const res = eval(calcEq + calcVal);
                calcVal = String(Number(res).toPrecision(8)).replace(/\.?0+$/, "");
                calcEq = '';
            } catch { calcVal = 'Error'; }
            updateCalc();
        }
        function calcFunc(f) {
            if (f === 'sqrt') calcVal = String(Math.sqrt(parseFloat(calcVal)));
            updateCalc();
        }
        function updateCalc() {
            const disp = document.getElementById('calc-display');
            const eq = document.getElementById('calc-eq');
            if(disp) disp.innerText = calcVal;
            if(eq) eq.innerText = calcEq;
        }

        // --- AI COACH ---
        async function callGeminiAPI(prompt, system) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{parts: [{text: prompt}]}],
                        systemInstruction: {parts: [{text: system}]}
                    })
                });
                const data = await response.json();
                return data.candidates[0].content.parts[0].text;
            } catch (e) { return null; }
        }

        async function fetchCoachTip() {
            const btn = document.querySelector('button[onclick="fetchCoachTip()"]');
            btn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i> LAKSHX AI ANALYZING...';
            const tip = await callGeminiAPI(
                "Provide a 1-sentence elite focus tip or academic physics/math fact for a top-tier student.",
                "You are an elite academic coach for LAKSHX students preparing for JEE and SAT. Be concise."
            );
            if (tip) document.getElementById('ai-insight').innerText = `"${tip.trim()}"`;
            btn.innerHTML = '<i data-lucide="sparkles" class="w-4 h-4"></i> ASK LAKSHX COACH';
            lucide.createIcons();
        }

        async function breakdownAI(id) {
            const task = tasks.find(t => t.id === id);
            const prompt = `Break this down into 3 tiny actionable steps for a LAKSHX student: ${task.text}`;
            const result = await callGeminiAPI(prompt, "Academic task breakdown assistant.");
            if (result) {
                const steps = result.split('\n').filter(s => s.trim()).slice(0, 3);
                const newTasks = steps.map((s, i) => ({ id: Date.now() + i, text: `↳ ${s.replace(/^\d\.\s*/, '')}`, completed: false }));
                const idx = tasks.findIndex(t => t.id === id);
                tasks.splice(idx + 1, 0, ...newTasks);
                saveAndRender();
            }
        }

        window.onload = () => {
            render();
            updateClock();
        };

    </script>
</body>
</html>